<template>
  <require from="../../../views/test-creator/steps/step-3/step-template.html"></require>

  <section class="editor">
    
    <section class="content-panel">
      <h1 style="font-size: 30px;text-align: center; margin-bottom: 40px;">Configured steps for <span class="text-pink">${config.name}</span></h1>

      <section class="flex step-config-wrapper">
        <section class="added-steps">
          <ul
            if.bind="config.steps.length > 0"
            style="
              margin: 0 auto;
              overflow: auto;
              list-style-type: none;
            "
          >
            <li
              repeat.for="step of config.steps"
              if.bind="step.groupName"
              class="group-steps"
            >
              <h2 class="group-name">${$index + 1} - ${step.groupName}</h2>
              <step-template
                class="flex flex--justify-between"
                style="padding: 5px 10px;display: flex;align-items: center;"

                repeat.for="innerStep of step.steps"
                index.bind="($parent.$index + 1) + '.' + ($index + 1)"
                step.bind="innerStep"
                icons.bind="icons"
                disableactions.bind="true"

                confirmupdatestep.bind="confirmUpdateStep"
                canceleditstep.bind="cancelEditStep"
                editstep.bind="editStep"
                deletestep.bind="deleteStep"
              ></step-template>
            </li>
            <li
              repeat.for="step of definedSteps"
              class="flex flex--justify-between"
              style="padding: 5px 10px;display: flex;align-items: center;"
              if.bind="!step.groupName"
            >
              <step-template
                class="flex flex--justify-between"
                style="padding: 5px 10px;display: flex;align-items: center;"

                index.bind="$index + 1"
                step.bind="step"
                icons.bind="icons"

                confirmupdatestep.bind="confirmUpdateStep"
                canceleditstep.bind="cancelEditStep"
                editstep.bind="editStep"
                deletestep.bind="deleteStep"
              ></step-template>
            </li>
          </ul>

        </section>
      </section>
    </section>
  </section>

  <div class="col-right">
    <section>
      <h4 class="header">
        Test history
      </h4>

      <div
        if.bind="testResults.length === 0"
        class="no-data-message"
      >
        No test history.
      </div>
      <section
        repeat.for="result of testResults"
        class="test-result ${$index === 0 ? 'first-child' : ''}"
      >
        ${result.startTime}

        <section
          class="ongoing"
          if.bind="result.ongoing"
        >
          Running...
        </section>
        <section
          class="pass-value"
          class.bind="result.testPassed ? 'passed' : 'failed'"
          if.bind="!result.ongoing"
        >
          ${result.testPassed ? 'Passed' : 'Failed'}
          <section
            class="score"
          >
            ${result.passed}/${result.total}
          </section>
          <button
            class="blue"
            click.trigger="viewTestResult(result)"
            innerhtml.bind="icons.magnifyingGlass"
            title="View result"
          ></button>
        </section>
      </section>
    </section>

    <button
      class="large padded-10 pink button"
      click.trigger="runTest()"
      style="margin-right: 10px;"
    >
      <span class="icon" style="margin-right: 5px;">&#9654;</span> Configure & Run
    </button>
  </div>
</template>
