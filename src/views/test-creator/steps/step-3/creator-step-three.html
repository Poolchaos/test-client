<template>
  <require from="./step-template.html"></require>

  <div class="wizard-step-3 flex">
    <section class="flex" style="width: 100%;height: 90%">
      <section class="is-relative left-column">
        <section
          id="js-step-item"
          repeat.for="group of steps"
        >
          <h4
            click.trigger="group.expanded = !group.expanded"
            class="stepGroup"
          >
            <span if.bind="group.expanded">â–¼</span>
            <span if.bind="!group.expanded ">&#9654;</span>
            ${group.title}
          </h4>
          <section class="flex flex--wrap" if.bind="group.expanded">
            <section
              class="step-type flex flex--direction-cols"
              class.bind="step.disabled ? 'u-faded-content' : ''"
              repeat.for="step of group.list"
              click.trigger="selectStepToAdd(step.name)"
            >
              <section class="blue svg" innerhtml.bind="icons[step.icon]"></section>
              <section class="flex flex--align-center" style="margin: auto;">${step.name}</section>
            </section>
            <section
              class="u-faded-content"
              if.bind="group.list.length === 0"
              style="margin: auto;padding: 10px;"
            >
              No items
            </section>
          </section>
        </section>
      </section>

      <section class="content-panel">
        <h2>Configured steps for <span class="text-pink">${testData.name}</span></h2>
        <div class="added-steps">
          <div
            if.bind="definedSteps.length === 0"
            style="
              height: 100%;
              display: flex;
              flex-direction: column;
              justify-content: center;
            "
          >
            <h4 class="text--dimmed">You have not yet added any steps.</h4>
            To add steps, select an item on the left.
            <section class="blue svg large" innerhtml.bind="icons.leftPointHand"></section>
          </div>
          <ul
            if.bind="definedSteps.length > 0"
            style="width: 600px;margin: 0 auto;overflow: auto;padding: 0 20px;"
          >
            <li
              repeat.for="step of definedSteps"
              if.bind="step.groupName"
              class="group"
            >
              <h2 class="group-name text-pink">${step.groupName}</h2>
              <section class="group-actions">
                <button
                  class="blue"
                  click.trigger="editStep(step)"
                  innerhtml.bind="icons.pencil"
                  if.bind="step.name !== 'click'"
                ></button>
                <button
                  class="pink"
                  click.trigger="deleteStepGroup(step)"
                  innerhtml.bind="icons.close"
                  style="margin-left: 0px;"
                ></button>
              </section>
              <step-template
                class="flex flex--justify-between"
                style="padding: 5px 10px;display: flex;align-items: center;"

                repeat.for="innerStep of step.steps"
                index.bind="($parent.$index + 1) + '.' + ($index + 1)"
                step.bind="innerStep"
                icons.bind="icons"
                disableactions.bind="true"

                confirmupdatestep.bind="confirmUpdateStep"
                canceleditstep.bind="cancelEditStep"
                editstep.bind="editStep"
                deletestep.bind="deleteStep"
              ></step-template>
            </li>
            <li
              repeat.for="step of definedSteps"
              class="flex flex--justify-between"
              style="padding: 5px 10px;display: flex;align-items: center;"
              if.bind="!step.groupName"
            >
              <step-template
                index.bind="$index"
                step.bind="step"
                icons.bind="icons"

                confirmupdatestep.bind="confirmUpdateStep"
                canceleditstep.bind="cancelEditStep"
                editstep.bind="editStep"
                deletestep.bind="deleteStep"
              ></step-template>
            </li>
          </ul>
        </div>
      </section>
    </section>

    <section class="flex">
      <button
        class="pink-button"
        style="padding: 20px;margin-right: 10px;"
        click.trigger="stepBack()"
      >
      &lt;&nbsp;&nbsp;Back
      </button>
      <button
        class="blue-button"
        style="padding: 20px;"
        click.trigger="submit()"
      >
        Finish
      </button>
    </section>
  </div>
</template>
